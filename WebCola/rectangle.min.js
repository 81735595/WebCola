var vpsc;(function(n){function e(n,t){return n.pos>t.pos?1:n.pos<t.pos?-1:n.isOpen?-1:0}function i(){return new RBTree(function(n,t){return n.pos-t.pos})}function u(u,f,o,s,h,c,l,a){var v,k=u.length,it=2*k,p,w,d,b,g,y,nt,tt;for(console.assert(f.length>=k),p=new Array(it),v=0;v<k;++v)w=u[v],y=new r(f[v],w,s(w)),p[v]=new t(!0,y,h(w)),p[v+k]=new t(!1,y,c(w));for(p.sort(e),d=[],b=i(),v=0;v<it;++v)g=p[v],y=g.v,g.isOpen?(b.insert(y),a(y,b)):(b.remove(y),nt=function(t,i){var r=(l(t.r)+l(i.r))/2+o;d.push(new n.Constraint(t.v,i.v,r))},tt=function(n,t,i){for(var r,u=y[n].iterator();(r=u[n]())!==null;)i(r,y),r[t].remove(y)},tt("prev","next",function(n,t){return nt(n,t)}),tt("next","prev",function(n,t){return nt(t,n)}));return console.assert(b.size===0),d}function o(n,t){var i=function(i,r){for(var e=t.findIter(n),u,f;(u=e[i]())!==null;)if(f=u.r.overlapX(n.r),(f<=0||f<=u.r.overlapY(n.r))&&(n[i].insert(u),u[r].insert(n)),f<=0)break};i("next","prev"),i("prev","next")}function s(n,t){var i=function(i,r){var u=t.findIter(n)[i]();u!==null&&u.r.overlapX(n.r)>0&&(n[i].insert(u),u[r].insert(n))};i("next","prev"),i("prev","next")}function h(n,t){return u(n,t,1e-6,function(n){return n.cx()},function(n){return n.y},function(n){return n.Y},function(n){return n.X-n.x},o)}function c(n,t){return u(n,t,1e-6,function(n){return n.cy()},function(n){return n.x},function(n){return n.X},function(n){return n.Y-n.y},s)}function l(t){var i=t.map(function(t){return new n.Variable(t.cx())}),r=n.generateXConstraints(t,i),u=new n.Solver(i,r);u.solve(),i.forEach(function(n,i){return t[i].setXCentre(n.position())}),i=t.map(function(t){return new n.Variable(t.cy())}),r=n.generateYConstraints(t,i),u=new n.Solver(i,r),u.solve(),i.forEach(function(n,i){return t[i].setYCentre(n.position())})}var f=function(){function n(n,t,i,r){this.x=n,this.X=t,this.y=i,this.Y=r}return n.prototype.cx=function(){return(this.x+this.X)/2},n.prototype.cy=function(){return(this.y+this.Y)/2},n.prototype.overlapX=function(n){var t=this.cx(),i=n.cx();return t<=i&&n.x<this.X?this.X-n.x:i<=t&&this.x<n.X?n.X-this.x:0},n.prototype.overlapY=function(n){var t=this.cy(),i=n.cy();return t<=i&&n.y<this.Y?this.Y-n.y:i<=t&&this.y<n.Y?n.Y-this.y:0},n.prototype.setXCentre=function(n){var t=n-this.cx();this.x+=t,this.X+=t},n.prototype.setYCentre=function(n){var t=n-this.cy();this.y+=t,this.Y+=t},n}(),r,t;n.Rectangle=f,r=function(){function n(n,t,r){this.v=n,this.r=t,this.pos=r,this.prev=i(),this.next=i()}return n}(),t=function(){function n(n,t,i){this.isOpen=n,this.v=t,this.pos=i}return n}(),n.generateXConstraints=h,n.generateYConstraints=c,n.removeOverlaps=l})(vpsc||(vpsc={}))